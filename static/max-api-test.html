<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAX API æ¸¬è©¦ - æ ¹æ“š ChatGPT å»ºè­°</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .result { padding: 15px; margin: 10px 0; border-radius: 8px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .price { font-size: 2em; color: #00b894; text-align: center; margin: 20px 0; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>ğŸ§ª MAX API æ¸¬è©¦ - æ ¹æ“š ChatGPT å»ºè­°</h1>
    <p>æ¸¬è©¦ ChatGPT æä¾›çš„ MAX API v2 ç«¯é»ï¼š<code>https://max-api.maicoin.com/api/v2/tickers/btctwd</code></p>
    
    <div id="results"></div>
    
    <script>
        async function testMaxAPI() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="result">ğŸ”„ é–‹å§‹æ¸¬è©¦...</div>';
            
            let html = '';
            
            // æ¸¬è©¦ 1: ç›´æ¥é€£æ¥ MAX API v2
            html += '<h3>ğŸ§ª æ¸¬è©¦ 1: ç›´æ¥é€£æ¥ MAX API v2</h3>';
            try {
                const response = await fetch('https://max-api.maicoin.com/api/v2/tickers/btctwd', {
                    method: 'GET',
                    mode: 'cors'
                });
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('MAX API v2 ç›´æ¥é€£æ¥éŸ¿æ‡‰:', data);
                    
                    // æ ¹æ“šå¯¦éš›æ ¼å¼è§£æï¼ˆç›´æ¥æœ‰ last å­—æ®µï¼‰
                    const price = parseFloat(data.last);
                    
                    if (price && price > 0) {
                        html += `<div class="result success">
                            âœ… <strong>ç›´æ¥é€£æ¥æˆåŠŸ</strong><br>
                            ğŸ’° BTC/TWD åƒ¹æ ¼: NT$${price.toLocaleString()}<br>
                            ğŸ“Š å®Œæ•´æ•¸æ“š: <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>`;
                        
                        // é¡¯ç¤ºåƒ¹æ ¼
                        html = `<div class="price">ğŸ’° BTC/TWD: NT$${price.toLocaleString()}</div>` + html;
                    } else {
                        html += `<div class="result error">
                            âŒ <strong>åƒ¹æ ¼è§£æå¤±æ•—</strong><br>
                            ğŸ“Š åŸå§‹æ•¸æ“š: <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>`;
                    }
                } else {
                    html += `<div class="result error">
                        âŒ <strong>HTTP éŒ¯èª¤</strong><br>
                        ç‹€æ…‹ç¢¼: ${response.status}<br>
                        ç‹€æ…‹æ–‡å­—: ${response.statusText}
                    </div>`;
                }
            } catch (error) {
                html += `<div class="result error">
                    âŒ <strong>ç›´æ¥é€£æ¥å¤±æ•— (CORS éŒ¯èª¤)</strong><br>
                    éŒ¯èª¤ä¿¡æ¯: ${error.message}
                </div>`;
                console.error('ç›´æ¥é€£æ¥éŒ¯èª¤:', error);
            }
            
            // æ¸¬è©¦ 2: ä½¿ç”¨ CORS ä»£ç†
            html += '<h3>ğŸ§ª æ¸¬è©¦ 2: ä½¿ç”¨ CORS ä»£ç† (allorigins.win)</h3>';
            try {
                const corsUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://max-api.maicoin.com/api/v2/tickers/btctwd');
                const response = await fetch(corsUrl);
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('CORS ä»£ç†éŸ¿æ‡‰:', data);
                    
                    const price = parseFloat(data.last);
                    
                    if (price && price > 0) {
                        html += `<div class="result success">
                            âœ… <strong>CORS ä»£ç†æˆåŠŸ</strong><br>
                            ğŸ’° BTC/TWD åƒ¹æ ¼: NT$${price.toLocaleString()}<br>
                            ğŸ“Š å®Œæ•´æ•¸æ“š: <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>`;
                    } else {
                        html += `<div class="result error">
                            âŒ <strong>CORS ä»£ç†åƒ¹æ ¼è§£æå¤±æ•—</strong><br>
                            ğŸ“Š åŸå§‹æ•¸æ“š: <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>`;
                    }
                } else {
                    html += `<div class="result error">
                        âŒ <strong>CORS ä»£ç† HTTP éŒ¯èª¤</strong><br>
                        ç‹€æ…‹ç¢¼: ${response.status}
                    </div>`;
                }
            } catch (error) {
                html += `<div class="result error">
                    âŒ <strong>CORS ä»£ç†å¤±æ•—</strong><br>
                    éŒ¯èª¤ä¿¡æ¯: ${error.message}
                </div>`;
                console.error('CORS ä»£ç†éŒ¯èª¤:', error);
            }
            
            // æ¸¬è©¦ 3: ä½¿ç”¨å¦ä¸€å€‹ CORS ä»£ç†
            html += '<h3>ğŸ§ª æ¸¬è©¦ 3: ä½¿ç”¨ CORS ä»£ç† (corsproxy.io)</h3>';
            try {
                const corsUrl2 = 'https://corsproxy.io/?' + encodeURIComponent('https://max-api.maicoin.com/api/v2/tickers/btctwd');
                const response = await fetch(corsUrl2);
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('CORS ä»£ç† 2 éŸ¿æ‡‰:', data);
                    
                    const price = parseFloat(data.last);
                    
                    if (price && price > 0) {
                        html += `<div class="result success">
                            âœ… <strong>CORS ä»£ç† 2 æˆåŠŸ</strong><br>
                            ğŸ’° BTC/TWD åƒ¹æ ¼: NT$${price.toLocaleString()}<br>
                            ğŸ“Š å®Œæ•´æ•¸æ“š: <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>`;
                    } else {
                        html += `<div class="result error">
                            âŒ <strong>CORS ä»£ç† 2 åƒ¹æ ¼è§£æå¤±æ•—</strong><br>
                            ğŸ“Š åŸå§‹æ•¸æ“š: <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>`;
                    }
                } else {
                    html += `<div class="result error">
                        âŒ <strong>CORS ä»£ç† 2 HTTP éŒ¯èª¤</strong><br>
                        ç‹€æ…‹ç¢¼: ${response.status}
                    </div>`;
                }
            } catch (error) {
                html += `<div class="result error">
                    âŒ <strong>CORS ä»£ç† 2 å¤±æ•—</strong><br>
                    éŒ¯èª¤ä¿¡æ¯: ${error.message}
                </div>`;
                console.error('CORS ä»£ç† 2 éŒ¯èª¤:', error);
            }
            
            html += `<div class="result">
                <h3>ğŸ“‹ ç¸½çµ</h3>
                <p>æ ¹æ“š ChatGPT çš„å»ºè­°ï¼ŒMAX API v2 ç«¯é»æ˜¯æ­£ç¢ºçš„ã€‚</p>
                <p>å¦‚æœç›´æ¥é€£æ¥å¤±æ•—ï¼Œé€šå¸¸æ˜¯å› ç‚º CORS é™åˆ¶ï¼Œéœ€è¦ä½¿ç”¨ä»£ç†æœå‹™ã€‚</p>
                <p>å¯¦éš›çš„ API æ ¼å¼æ˜¯ç›´æ¥è¿”å›å­—æ®µï¼Œè€Œä¸æ˜¯åŒ…åœ¨ ticker å°è±¡ä¸­ã€‚</p>
            </div>`;
            
            resultsDiv.innerHTML = html;
        }
        
        // é é¢è¼‰å…¥å¾ŒåŸ·è¡Œæ¸¬è©¦
        document.addEventListener('DOMContentLoaded', testMaxAPI);
        
        // æ·»åŠ é‡æ–°æ¸¬è©¦æŒ‰éˆ•
        document.addEventListener('DOMContentLoaded', function() {
            const button = document.createElement('button');
            button.textContent = 'ğŸ”„ é‡æ–°æ¸¬è©¦';
            button.style.cssText = 'padding: 10px 20px; background: #6c5ce7; color: white; border: none; border-radius: 6px; cursor: pointer; margin: 20px 0;';
            button.onclick = testMaxAPI;
            document.body.insertBefore(button, document.getElementById('results'));
        });
    </script>
</body>
</html>