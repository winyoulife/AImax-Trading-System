<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AImax é›²ç«¯æ¸¬è©¦ç‰ˆ</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .card { background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .price { font-size: 2em; color: #00b894; text-align: center; margin: 20px 0; }
        .status { padding: 10px; border-radius: 4px; margin: 10px 0; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .loading { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <h1>ğŸ¤– AImax é›²ç«¯æ¸¬è©¦ç‰ˆ</h1>
    
    <div class="card">
        <h2>ğŸ’° BTC/TWD åƒ¹æ ¼æ¸¬è©¦</h2>
        <div class="price" id="price">è¼‰å…¥ä¸­...</div>
        <div id="status" class="status loading">æ­£åœ¨æ¸¬è©¦ API é€£æ¥...</div>
        <div id="details"></div>
    </div>
    
    <script>
        async function testAPI() {
            const priceEl = document.getElementById('price');
            const statusEl = document.getElementById('status');
            const detailsEl = document.getElementById('details');
            
            // æ¸¬è©¦æ–¹æ³•åˆ—è¡¨
            const methods = [
                {
                    name: 'ç›´æ¥é€£æ¥ MAX API',
                    test: async () => {
                        const response = await fetch('https://max-api.maicoin.com/api/v2/tickers/btctwd', {
                            method: 'GET',
                            mode: 'cors'
                        });
                        const data = await response.json();
                        return { price: parseFloat(data.last), source: 'ç›´æ¥é€£æ¥' };
                    }
                },
                {
                    name: 'CORS ä»£ç† (allorigins.win)',
                    test: async () => {
                        const corsUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://max-api.maicoin.com/api/v2/tickers/btctwd');
                        const response = await fetch(corsUrl);
                        const data = await response.json();
                        return { price: parseFloat(data.last), source: 'CORS ä»£ç†' };
                    }
                },
                {
                    name: 'CORS ä»£ç† (corsproxy.io)',
                    test: async () => {
                        const corsUrl = 'https://corsproxy.io/?' + encodeURIComponent('https://max-api.maicoin.com/api/v2/tickers/btctwd');
                        const response = await fetch(corsUrl);
                        const data = await response.json();
                        return { price: parseFloat(data.last), source: 'CORS ä»£ç† 2' };
                    }
                },
                {
                    name: 'å‚™ç”¨åƒ¹æ ¼',
                    test: async () => {
                        return { price: 3450000, source: 'å‚™ç”¨æ•¸æ“š' };
                    }
                }
            ];
            
            let details = '<h3>æ¸¬è©¦çµæœ:</h3>';
            
            for (const method of methods) {
                try {
                    details += `<p>ğŸ”„ æ¸¬è©¦ ${method.name}...</p>`;
                    const result = await method.test();
                    
                    if (result.price && result.price > 0) {
                        priceEl.textContent = `NT$${result.price.toLocaleString()}`;
                        statusEl.textContent = `âœ… æˆåŠŸé€£æ¥ (${result.source})`;
                        statusEl.className = 'status success';
                        details += `<p>âœ… ${method.name}: NT$${result.price.toLocaleString()}</p>`;
                        break;
                    }
                } catch (error) {
                    details += `<p>âŒ ${method.name}: ${error.message}</p>`;
                    console.error(`${method.name} å¤±æ•—:`, error);
                }
            }
            
            detailsEl.innerHTML = details;
            
            if (statusEl.className.includes('loading')) {
                statusEl.textContent = 'âŒ æ‰€æœ‰é€£æ¥æ–¹å¼éƒ½å¤±æ•—';
                statusEl.className = 'status error';
                priceEl.textContent = 'ç„¡æ³•ç²å–åƒ¹æ ¼';
            }
        }
        
        // é é¢è¼‰å…¥å¾ŒåŸ·è¡Œæ¸¬è©¦
        document.addEventListener('DOMContentLoaded', testAPI);
        
        // æ¯30ç§’é‡æ–°æ¸¬è©¦
        setInterval(testAPI, 30000);
    </script>
</body>
</html>