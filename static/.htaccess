# AImax 私有交易系統安全配置

# 強制HTTPS
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# 安全標頭
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "strict-origin-when-cross-origin"
Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' api.github.com; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self' api.github.com; font-src 'self'"

# 禁止目錄瀏覽
Options -Indexes

# 隱藏敏感文件
<Files ~ "^\.">
    Order allow,deny
    Deny from all
</Files>

# 禁止訪問配置文件
<Files ~ "\.(json|md|txt|log)$">
    Order allow,deny
    Deny from all
</Files>

# 只允許必要的文件類型
<FilesMatch "\.(html|css|js|png|jpg|jpeg|gif|ico|svg)$">
    Order allow,deny
    Allow from all
</FilesMatch>