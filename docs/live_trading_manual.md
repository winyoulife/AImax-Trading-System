# 📚 AImax 實盤交易完整操作手冊

## 🎯 **手冊概述**
本手冊提供AImax三AI協作交易系統的完整實盤交易指南，包括操作流程、風險管理、緊急處理和系統維護。

**版本**: 1.0  
**更新日期**: 2025年1月24日  
**適用系統**: AImax v1.0  

---

## 🚀 **快速開始指南**

### **系統啟動流程**
1. **環境檢查**
   ```bash
   # 檢查Python環境
   python --version  # 需要 3.10+
   
   # 檢查依賴
   pip install -r AImax/requirements.txt
   
   # 檢查Ollama服務
   ollama list  # 確認 llama2:7b 和 qwen:7b 已安裝
   ```

2. **系統啟動**
   ```bash
   # 啟動GUI監控界面
   python AImax/scripts/run_gui_final.py
   
   # 或啟動命令行版本
   python AImax/scripts/test_trading_system_clean.py
   ```

3. **安全檢查**
   - ✅ 確認風險控制規則已激活
   - ✅ 驗證緊急停止機制正常
   - ✅ 檢查資金限制設置
   - ✅ 確認API連接穩定

---

## ⚙️ **系統配置**

### **交易參數配置**
```json
{
  "trading_config": {
    "max_position_size": 0.01,
    "max_daily_loss": 0.015,
    "confidence_threshold": 0.65,
    "risk_reward_ratio": 1.5,
    "trading_pair": "BTCTWD"
  }
}
```

### **AI協作權重配置**
```json
{
  "ai_weights": {
    "market_scanner": 0.35,
    "deep_analyst": 0.35,
    "decision_maker": 0.30
  }
}
```

### **風險控制配置**
```json
{
  "risk_controls": {
    "max_single_trade": 500,
    "daily_loss_limit": 1500,
    "consecutive_loss_limit": 3,
    "emergency_stop_loss": 0.05
  }
}
```

---

## 🛡️ **風險管理指南**

### **多層風險防護**

#### **第1層：AI決策層風險控制**
- **信心度閾值**: 低於65%的決策不執行
- **一致性檢查**: 三AI必須達成共識
- **市場條件驗證**: 不在異常市場條件下交易

#### **第2層：市場風險控制**
- **波動率檢查**: 超過5%波動率暫停交易
- **流動性驗證**: 確保足夠的市場深度
- **時間窗口限制**: 只在交易時間內執行

#### **第3層：資金風險控制**
- **單筆限額**: 每筆交易不超過500 TWD
- **日損失限制**: 每日損失不超過1.5%
- **總倉位限制**: 總倉位不超過1%

#### **第4層：技術風險控制**
- **API限制**: 防止過度頻繁調用
- **系統監控**: 實時監控系統健康狀態
- **自動恢復**: 系統異常時自動恢復

#### **第5層：緊急風險控制**
- **緊急停止**: 一鍵停止所有交易
- **強制平倉**: 緊急情況下強制平倉
- **系統隔離**: 完全斷開交易連接

### **風險等級定義**

| 風險等級 | 描述 | 處理方式 |
|---------|------|----------|
| 🟢 低風險 | 正常市場條件，AI高信心度 | 正常執行交易 |
| 🟡 中風險 | 市場波動增加，AI中等信心度 | 降低倉位，提高監控 |
| 🟠 高風險 | 市場異常，AI低信心度 | 暫停交易，觀望 |
| 🔴 極高風險 | 系統異常，連續虧損 | 緊急停止，人工介入 |

---

## 🚨 **緊急處理指南**

### **常見緊急情況處理**

#### **1. 系統異常停止**
**症狀**: 系統突然停止響應
**處理步驟**:
1. 檢查系統日誌: `AImax/logs/`
2. 重啟Ollama服務: `ollama serve`
3. 重新啟動系統: `python AImax/scripts/run_gui_final.py`
4. 驗證所有組件正常

#### **2. API連接失敗**
**症狀**: 無法獲取市場數據或執行交易
**處理步驟**:
1. 檢查網絡連接
2. 驗證API密鑰有效性
3. 檢查MAX交易所狀態
4. 重新建立連接

#### **3. AI決策異常**
**症狀**: AI返回異常決策或無響應
**處理步驟**:
1. 檢查AI模型狀態: `ollama list`
2. 重啟AI服務: `ollama serve`
3. 檢查提示詞配置
4. 驗證AI響應正常

#### **4. 連續虧損**
**症狀**: 連續3筆以上虧損交易
**處理步驟**:
1. 立即暫停自動交易
2. 分析虧損原因
3. 檢查市場條件變化
4. 調整策略參數
5. 小額測試後恢復

#### **5. 資金異常**
**症狀**: 資金變動異常或超出限制
**處理步驟**:
1. 立即停止所有交易
2. 檢查交易記錄
3. 驗證帳戶餘額
4. 聯繫交易所客服
5. 人工審核後決定是否恢復

### **緊急聯繫方式**
- **MAX交易所客服**: [官方客服]
- **系統開發者**: [聯繫方式]
- **緊急停止熱鍵**: Ctrl+C

---

## 📊 **系統監控指南**

### **關鍵監控指標**

#### **系統健康指標**
- **CPU使用率**: < 80%
- **內存使用率**: < 80%
- **響應時間**: < 5秒
- **錯誤率**: < 1%

#### **交易性能指標**
- **勝率**: > 60%
- **平均收益**: > 1%
- **最大回撤**: < 5%
- **夏普比率**: > 1.0

#### **AI決策指標**
- **平均信心度**: > 65%
- **決策一致性**: > 90%
- **響應時間**: < 30秒
- **決策頻率**: 適中

### **監控工具使用**

#### **實時監控界面**
```bash
python AImax/scripts/run_gui_final.py
```
- 實時顯示系統狀態
- AI決策過程可視化
- 交易執行監控
- 風險指標追蹤

#### **日誌監控**
```bash
# 查看系統日誌
tail -f AImax/logs/system.log

# 查看交易日誌
tail -f AImax/logs/trading.log

# 查看AI決策日誌
tail -f AImax/logs/ai_decisions.log
```

#### **性能分析**
```bash
# 執行性能分析
python AImax/scripts/analyze_live_test_results.py

# 查看穩定性測試
python AImax/scripts/system_stability_test.py
```

---

## 🔧 **系統維護指南**

### **日常維護任務**

#### **每日檢查清單**
- [ ] 檢查系統運行狀態
- [ ] 查看交易執行記錄
- [ ] 監控資金變動
- [ ] 檢查錯誤日誌
- [ ] 驗證AI模型狀態
- [ ] 確認風險控制正常

#### **每週維護任務**
- [ ] 清理舊日誌文件
- [ ] 更新市場數據
- [ ] 分析交易性能
- [ ] 優化AI參數
- [ ] 備份重要數據
- [ ] 檢查系統更新

#### **每月維護任務**
- [ ] 全面性能評估
- [ ] 策略效果分析
- [ ] 系統穩定性測試
- [ ] 風險控制評估
- [ ] 文檔更新
- [ ] 災難恢復測試

### **數據備份策略**

#### **備份內容**
- 交易記錄數據
- AI決策日誌
- 系統配置文件
- 性能分析報告

#### **備份頻率**
- **實時備份**: 交易記錄
- **每日備份**: 系統日誌
- **每週備份**: 完整數據
- **每月備份**: 歸檔數據

#### **備份命令**
```bash
# 創建備份
python AImax/scripts/backup_system_data.py

# 恢復備份
python AImax/scripts/restore_system_data.py
```

---

## 📈 **性能優化指南**

### **系統性能優化**

#### **AI響應速度優化**
- 使用並行處理
- 優化提示詞長度
- 緩存常用計算結果
- 調整模型參數

#### **數據處理優化**
- 實現數據緩存
- 優化數據庫查詢
- 使用異步處理
- 減少不必要的API調用

#### **內存使用優化**
- 及時釋放不用的對象
- 使用生成器處理大數據
- 優化數據結構
- 定期清理緩存

### **交易策略優化**

#### **參數調優**
- 基於歷史數據回測
- A/B測試不同參數
- 動態調整閾值
- 監控優化效果

#### **風險控制優化**
- 根據市場條件調整
- 動態風險限額
- 智能止損策略
- 多樣化風險指標

---

## 🔍 **故障排除指南**

### **常見問題解決**

#### **問題1: AI響應緩慢**
**可能原因**:
- Ollama服務負載過高
- 系統資源不足
- 網絡延遲

**解決方案**:
1. 重啟Ollama服務
2. 檢查系統資源使用
3. 優化AI提示詞
4. 調整並發參數

#### **問題2: 交易執行失敗**
**可能原因**:
- API權限問題
- 資金不足
- 市場流動性不足
- 網絡連接問題

**解決方案**:
1. 檢查API密鑰和權限
2. 確認帳戶餘額充足
3. 檢查市場深度
4. 測試網絡連接

#### **問題3: 數據獲取異常**
**可能原因**:
- API限制
- 數據源問題
- 本地緩存損壞

**解決方案**:
1. 檢查API調用頻率
2. 驗證數據源狀態
3. 清理並重建緩存
4. 使用備用數據源

### **日誌分析指南**

#### **系統日誌位置**
```
AImax/logs/
├── system.log          # 系統運行日誌
├── trading.log         # 交易執行日誌
├── ai_decisions.log    # AI決策日誌
├── errors.log          # 錯誤日誌
└── performance.log     # 性能監控日誌
```

#### **日誌分析命令**
```bash
# 查找錯誤
grep "ERROR" AImax/logs/system.log

# 分析交易記錄
grep "TRADE" AImax/logs/trading.log

# 監控AI決策
grep "DECISION" AImax/logs/ai_decisions.log
```

---

## 📋 **檢查清單**

### **系統啟動前檢查**
- [ ] Python環境正常 (3.10+)
- [ ] 依賴包已安裝
- [ ] Ollama服務運行中
- [ ] AI模型已載入
- [ ] MAX API連接正常
- [ ] 風險控制規則已設置
- [ ] 緊急停止機制已測試

### **交易執行前檢查**
- [ ] 市場開放時間
- [ ] 帳戶餘額充足
- [ ] 風險限額設置合理
- [ ] AI系統響應正常
- [ ] 監控界面運行中
- [ ] 備份機制已啟動

### **系統關閉前檢查**
- [ ] 所有交易已完成
- [ ] 數據已保存
- [ ] 日誌已備份
- [ ] 系統狀態已記錄
- [ ] 緊急聯繫方式已確認

---

## 📞 **技術支持**

### **自助解決**
1. 查閱本手冊相關章節
2. 檢查系統日誌
3. 運行診斷工具
4. 參考FAQ文檔

### **聯繫支持**
- **技術問題**: 提供詳細錯誤信息和日誌
- **交易問題**: 提供交易時間和相關記錄
- **緊急情況**: 立即停止系統並聯繫

---

## 📝 **更新記錄**

### **v1.0 (2025-01-24)**
- 初始版本發布
- 完整操作流程
- 風險管理指南
- 緊急處理程序
- 系統監控方案

---

*本手冊將根據系統更新和用戶反饋持續改進*  
*最後更新: 2025年1月24日*